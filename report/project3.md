تمرین گروهی ۳ - گزارش تغییرات نسبت به طراحی
======================

گروه 7
-----

>>‫نام و آدرس پست الکترونیکی اعضای گروه را در این قسمت بنویسید.

محمدسپهر پورقناد sepehrpourghannad@yahoo.com
سیدمحمدصادق کشاورزی mohammadsadeghkeshavarzi@yahoo.com
فرزام زهدی‌نسب farzamzohdi@gmail.com
مصطفی اوجاقی m.ojaghy@gmail.com

بافر کش
============

داده‌ساختار‌ها و توابع
---------------------

>>‫ در این قسمت تعریف هر یک از `struct` ها، اعضای `struct` ها، متغیرهای سراسری یا ایستا، `typedef` ها یا `enum` هایی که ایجاد کرده‌اید یا تغییر داده‌اید را‫ بنویسید و دلیل هر کدام را در حداکثر ۲۵ کلمه توضیح دهید.
```
lock cache_lock;

struct cache_block {
	lock lock;
	...
	int access_count;
}

void cache_flush ();
```

`cache_lock`: قفلی است که هنگام دسترسی به `cache` و `cache_hash` بکار می‌رود.
`lock`:برای هنگام سازی یک بلوک کش بکار می‌رود.
`access_count`: تعداد ریسه‌هایی که در حال حاضر در حال استفاده از بلوک کش هستند.
این ۳ مورد در طراحی اولیه وجود داشتند اما پیاده‌سازی بدون استفاده از آن‌ها صورت گرفت.
همچنین یک تابع`cache_flush ()` در پیاده‌سازی اضافه شد که زمانی کاربرد دارد که برای مثال سیستم `shut_down` شود. در چنین شرایطی نیاز است که قبل از خاموش شدن سیستم آنچه در کش باقی مانده است را منتقل کنیم.

زیرمسیرها
============

داده‌ساختار‌ها و توابع
----------------

>>‫ در این قسمت تعریف هر یک از `struct` ها، اعضای `struct` ها، متغیرهای سراسری‫ یا ایستا، `typedef` ها یا `enum` هایی که ایجاد کرده‌اید یا تغییر داده‌اید را بنویسید و‫ دلیل هر کدام را در حداکثر ۲۵ کلمه توضیح دهید.

```
struct thread {
	...
	block_sector_t cwd;
}

struct inode_disk {
	...
	bool is_dir;
	...
}
```



`cwd`: در طراحی اولیه از جنس `*dir` تعریف شده بود. `dir*` به چیزی در حافظه اشاره می‌کند و جهت اطمینان از اینکه مشکلی بوجود نیاید آن را به `block_sector_t` تغییر دادیم تا از روی دیسک خوانده و مطمئن باشیم.

`is_dir`: در طراحی اولیه بجای `inode_disk` در `dir_entry` قرار داشت. که یعنی در حافظه قرار داشت اما به این زمانی که پرونده را می‌بستیم همچنان به این اطلاعات نیاز داشتیم بنابراین آن را به `inode_disk` منتقل کردیم.

الگوریتم‌ها
-----------

>>‫ کد خود را برای طی کردن یک مسیر گرفته‌شده از کاربر را توضیح دهید.‫ آیا عبور از مسیرهای absolute و relative تفاوتی دارد؟
 در تابع `get_path()`، در ابتدا با توجه به مطلق یا نسبی بودن ورودی،‌ پوشه اولیه را مشخص می‌کنیم. سپس ورودی را `parse` کرده و ضمن توجه به `..`ها حرکت می‌کنیم. برای حرکت روبه داخل برای پوشه ها، از تابع `dir_lookup` استفاده می‌کنیم تا متوجه شویم که آیا پوشه‌ی فعلی موجود است یا خیر. در صورتی که موجود بود، یا `dir_open` ، پوشه جدید را بدست می‌اوردیم و `cwd` را متناسبا عوض می‌کنیم. در صورتی هم که بخواهیم احیانا به پوشه‌(های) پدر برویم، ابتدا از طریق `cwd` ، به ‍`inode` دسترسی پیدا می‌کنیم. سپس به `inode_disk` مربوطه و از آن طریق به  `block_sector_t parent_dir` می‌رسیم که همان محل ذخیره پوشه پدر در دیسک است. در نهایت هم با استفاده از `inode_open`  به `inode` پدر است. و می‌توانیم عملیات دلخواه خود را روی آن انجام دهیم.

تست‌ها
==========

تست اول
------
> توضیح دهید تست شما دقیقا چه چیزی را تست می کند.
>  توضیح دهید چگونه این امر را تست می کنید و همینطور به صورت کیفی بیان کنید که خروجی مورد نظر باید چگونه باشد تا تست پاس شود.
>   خروجی خود هسته وقتی تست اجرا می شود و همچنین خروجی تست را در این بخش بیاورید.برای اینکار محتوای دو فایل -your.کنید کپی را شود می یافت filesys/build/tests/filesys/extended مسیر در که your-test-1.result و test-1.output
>   دو ایراد بالقوه و غیر بدیهی هسته را بیان کنید و نشان دهید که در صورت بروز این خطا تست شما چه خروجی خواهد داشت.گزارش
شما باید به این صورت باشد:
“اگر هسته X را به جای Y انجام دهد آنگاه خروجی تست Z خواهد بود.“
شما باید برای هر تست دو ایراد مجزا پیدا کنید اما ایراد های دو تست می تواند یکسان باشد یا اشتراک داشته باشند.لازم به ذکر
است که ایراد بیان شده باید مربوط به سناریو تست شما باشد به عنوان مثال سناریو زیر قابل قبول نیست: اگر هسته خطای نحوی
۱۳ داشته باشد آنگاه تست اجرا نمی شود

تست دوم
------
همون چیزای بالا رو برای این هم باید گزارش بشه.

صحبت پایانی
-----
> در آخر تجربه خود از نوشتن تست برای Pintos را برای ما بیان کنید. نمره این بخش بر اساس تلاش شما که در نوشتن گزارش منعکس می شود داده می شود و اگر بخش های بالا تکمیل باشد نگرانی از جهت نمره برای این بخش نداشته باشید.

کار تیمی
============
هماهنگی‌ها تقریبا مشابه با فاز‌های گذشته بودند و توضیحات دقیق‌تر از نحوه تعامل و کار تیمی در گزارشات گذشته موجود است. 
